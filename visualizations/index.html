<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>MinnPost</title>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <link type="text/css" rel="stylesheet" media="all" href="http://www.minnpost.com/sites/default/files/css/css_bb801627df93671ec2cf2a1c9ecf4ad2.css" />
  <link type="text/css" rel="stylesheet" media="screen" href="http://www.minnpost.com/sites/default/files/css/css_b833827e9fdb99e83e393d38c32a71fd.css" />
  <link type="text/css" rel="stylesheet" media="print" href="http://www.minnpost.com/sites/default/files/css/css_dd48b5b093a35515052acfc42613d628.css" />
  <!--[if IE]>
      <link rel="stylesheet" href="http://www.minnpost.com/sites/default/themes/derma/inc/css/ie.css?j" type="text/css">
  <![endif]-->
  <meta name="viewport" content="width=device-width, initial-scale=1"></meta>
</head>
<body class="front logged-in page-home one-sidebar sidebar-right admin-nw admin-vertical admin-df  one-sidebar sidebar-right">


  <!-- Embed Start -->
  <div class="node-body fieldlayout node-field-body">
    <style type="text/css">
      @import url('http://data.minnpost.s3.amazonaws.com/js/leaflet-0.3.1/leaflet.css');
    </style>
    <!--[if lte IE 8]>
      <style type="text/css">
        @import url('http://data.minnpost.s3.amazonaws.com/js/leaflet-0.3.1/leaflet.ie.css');
      </style>
    <![endif]-->
    <style type="text/css">
      .js-dependent,
      .hide {
        display: none;
      }
      
      .footnote {
        font-size: .75em;
        font-style: italic;
        color: #414141;
        margin-top: 1em;
      }
      
      #map {
        width: 100%;
        height: 550px;
      }
      
      /** Media queries **/
      @media all and (max-width: 750px) {
      }
    </style>
    
    <div id="map"></div>
    
    <p class="footnote">.</p>
  
    <script type="text/javascript">window.jQuery || document.write('<script type="text/javascript" src="https://s3.amazonaws.com/data.minnpost/js/jquery-1.7.2/jquery-1.7.2.min.js"><\/script>')</script>
    
    <script type="text/javascript" src="https://s3.amazonaws.com/data.minnpost/js/leaflet-0.3.1/leaflet.js"></script>
    <script type="text/javascript" src="https://s3.amazonaws.com/data.minnpost/js/berniecode-animator-20120521/animator.min.js"></script>
    <script type="text/javascript">
      // Converts numeric degrees to radians
      if (typeof(Number.prototype.toRad) === "undefined") {
        Number.prototype.toRad = function() {
          return this * Math.PI / 180;
        }
      }
      // Converts radians to numeric (signed) degrees
      if (typeof(Number.prototype.toDeg) === "undefined") {
        Number.prototype.toDeg = function() {
          return this * 180 / Math.PI;
        }
      }
    
      // Object for dealing with map data
      var mapExtender = {};
      mapExtender.lineDistance = function(line) {
        // Get distance of geojson object
        var dist = 0;
        
        if (typeof line.type != 'undefined' && line.type == 'LineString') {
          for (var i = 1; i < line.coordinates.length; i++) {
            dist += mapExtender.coordDistance(line.coordinates[i], line.coordinates[i - 1]);
          }
          
          return dist;
        }
        else {
          return dist;
        }
      };
      mapExtender.coordDistance = function(coord1, coord2) {
        // Get Haversine distance between two Geojson coordinates
        var dLat = (coord2[1] - coord1[1]).toRad();
        var dLon = (coord2[0] - coord1[0]).toRad();
        var lat1 = coord1[1].toRad();
        var lat2 = coord2[1].toRad();
        
        var a = Math.sin(dLat/2) * Math.sin(dLat/2) + Math.sin(dLon/2) * Math.sin(dLon/2) * Math.cos(lat1) * Math.cos(lat2); 
        var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a)); 
        return c;
      };
      mapExtender.coordAtDistance = function(line, dist) {
        // Gets coordinate at specific place along path
        var coord = [];
        var distCurrent = 0;
        var distOld = 0;
        
        // If 0, then just give the first coordinate back.
        if (dist == 0) {
          return line.coordinates[0];
        }

        // Got to each coordinate and check if we need to go to next;
        for (var i = 1; (i < line.coordinates.length && distCurrent < dist); i++) {
          distOld = distCurrent;
          distCurrent += mapExtender.coordDistance(line.coordinates[i], line.coordinates[i - 1]);
        }
        
        // Check if we did not make it
        if (distCurrent < dist) {
          return coord;
        }
        var p1 = line.coordinates[i - 2];
        var p2 = line.coordinates[i - 1];
        var part = (dist - distOld) / (distCurrent - distOld);

        // Lon
        coord[0] = p1[0] + (p2[0] - p1[0]) * part;
        coord[1] = p1[1] + (p2[1] - p1[1]) * part;
        return coord;
      }
      mapExtender.toKM = function(v) {
        // Returns KM from a lat/lon distance;
        return v * 6371;
      };
      mapExtender.toM = function(v) {
        // Returns M from a lat/lon distance;
        return v * 6371 * 1000;
      };
      
      
      // Namespace jQuery
      (function($) {
        $(document).ready(function() {
          var example_paths = [
            {"type":"LineString","coordinates":[[-93.245688000000001,44.963118000000001],[-93.245683999999997,44.964027000000002],[-93.245097000000001,44.963470000000001],[-93.244298999999998,44.964398000000003],[-93.244095000000002,44.964900999999998],[-93.244084999999998,44.965291000000001],[-93.244084999999998,44.966616000000002],[-93.24409,44.967736000000002],[-93.244073999999998,44.968870000000003],[-93.244078999999999,44.969437999999997],[-93.244079999999997,44.969527999999997],[-93.244082000000006,44.969790000000003],[-93.244084000000001,44.969973000000003],[-93.245658000000006,44.969999999999999],[-93.245649,44.970933000000002],[-93.245665000000002,44.971127000000003],[-93.245711,44.971581999999998],[-93.245774999999995,44.972394000000001],[-93.245874999999998,44.973382999999998],[-93.245818999999997,44.973492999999998],[-93.245806000000002,44.974224999999997],[-93.245757999999995,44.975347999999997],[-93.245410000000007,44.976004000000003],[-93.244325000000003,44.977462000000003],[-93.243542000000005,44.979902000000003],[-93.242765000000006,44.980907000000002],[-93.242109999999997,44.981718999999998],[-93.241322999999994,44.982703999999998],[-93.240540999999993,44.983687000000003],[-93.239158000000003,44.983136000000002],[-93.237761000000006,44.982581000000003],[-93.236406000000002,44.982028],[-93.236795999999998,44.981535999999998],[-93.236977999999993,44.981307000000001],[-93.237182000000004,44.981050000000003],[-93.237373000000005,44.981124999999999]]},
            {"type":"LineString","coordinates":[[-93.245688000000001,44.963118000000001],[-93.245683999999997,44.964027000000002],[-93.245097000000001,44.963470000000001],[-93.244298999999998,44.964398000000003],[-93.244095000000002,44.964900999999998],[-93.244084999999998,44.965291000000001],[-93.244084999999998,44.966616000000002],[-93.24409,44.967736000000002],[-93.244073999999998,44.968870000000003],[-93.244078999999999,44.969437999999997],[-93.244079999999997,44.969527999999997],[-93.244082000000006,44.969790000000003],[-93.244084000000001,44.969973000000003],[-93.243095999999994,44.969977999999998],[-93.242602000000005,44.969977],[-93.242114999999998,44.969999000000001],[-93.241895999999997,44.970002999999998],[-93.241084000000001,44.970191],[-93.240624999999994,44.970182000000001],[-93.240323000000004,44.970101999999997],[-93.239586000000003,44.969681999999999],[-93.238400999999996,44.969074999999997],[-93.238149000000007,44.969059000000001],[-93.237977000000001,44.969160000000002],[-93.238167000000004,44.969253000000002],[-93.238107999999997,44.969313999999997],[-93.239338000000004,44.969935999999997],[-93.239965999999995,44.970427000000001],[-93.240325999999996,44.970872],[-93.240682000000007,44.971189000000003],[-93.240790000000004,44.971488999999998],[-93.240972999999997,44.971693999999999],[-93.241197999999997,44.972341999999998],[-93.241331000000002,44.973599],[-93.241406999999995,44.974159],[-93.241829999999993,44.974874999999997],[-93.241857999999993,44.975239000000002],[-93.241631999999996,44.975934000000002],[-93.241657000000004,44.97636],[-93.241844999999998,44.976799],[-93.242199999999997,44.977162999999997],[-93.242912000000004,44.977504000000003],[-93.243761000000006,44.977536999999998],[-93.244343000000001,44.977645000000003],[-93.244405,44.977547999999999],[-93.244572000000005,44.977547999999999],[-93.244738999999996,44.97757],[-93.246309999999994,44.977818999999997],[-93.246840000000006,44.977758000000001],[-93.247561000000005,44.977555000000002],[-93.249055999999996,44.977637999999999],[-93.249937000000003,44.977558000000002],[-93.250913999999995,44.977634999999999],[-93.251344000000003,44.977789000000001],[-93.251935000000003,44.97813],[-93.252737999999994,44.978369999999998],[-93.253974999999997,44.978498000000002],[-93.254748000000006,44.978668999999996],[-93.255408000000003,44.978710999999997],[-93.255885000000006,44.978983999999997],[-93.258304999999993,44.980024],[-93.258595,44.980321000000004],[-93.258954000000003,44.980564999999999],[-93.259400999999997,44.980789999999999],[-93.259659999999997,44.981034999999999],[-93.259867,44.981315000000002],[-93.260239999999996,44.981555],[-93.261424000000005,44.982050000000001],[-93.262296000000006,44.982922000000002],[-93.264155000000002,44.984324999999998],[-93.264415999999997,44.984431999999998],[-93.264619999999994,44.984484999999999],[-93.264970000000005,44.984572999999997],[-93.265266999999994,44.984842999999998],[-93.265511000000004,44.985356000000003],[-93.266323,44.985970000000002],[-93.266385999999997,44.986162999999998],[-93.266694999999999,44.986477000000001],[-93.266870999999995,44.986431000000003],[-93.267347999999998,44.987271],[-93.268432000000004,44.987020999999999],[-93.270027999999996,44.986562999999997],[-93.273266000000007,44.985464999999998],[-93.274234000000007,44.985058000000002],[-93.277370000000005,44.982869999999998],[-93.278334000000001,44.982391999999997],[-93.279641999999996,44.981482],[-93.279882000000001,44.981236000000003],[-93.281755000000004,44.979877999999999],[-93.281379000000001,44.980038999999998],[-93.281142000000003,44.979998000000002],[-93.281019999999998,44.979882000000003],[-93.280964999999995,44.979247999999998],[-93.281025999999997,44.979148000000002],[-93.281357999999997,44.979061999999999],[-93.281475999999998,44.978983999999997],[-93.281632999999999,44.978988000000001],[-93.281632999999999,44.978904999999997],[-93.281598000000002,44.977933999999998],[-93.281598000000002,44.977463999999998],[-93.281495000000007,44.976944000000003],[-93.281346999999997,44.976581000000003],[-93.281118000000006,44.976056999999997],[-93.281037999999995,44.975890999999997],[-93.280844999999999,44.975343000000002],[-93.280358000000007,44.974767999999997],[-93.279966999999999,44.974290000000003],[-93.279571000000004,44.973806000000003],[-93.278829999999999,44.972920000000002],[-93.278698000000006,44.972881000000001],[-93.277789999999996,44.972639999999998],[-93.276393999999996,44.972053000000002],[-93.276298999999995,44.972150999999997]]},
            {"type":"LineString","coordinates":[[-93.245688000000001,44.963118000000001],[-93.245683999999997,44.964027000000002],[-93.245097000000001,44.963470000000001],[-93.244298999999998,44.964398000000003],[-93.244095000000002,44.964900999999998],[-93.244084999999998,44.965291000000001],[-93.244084999999998,44.966616000000002],[-93.24409,44.967736000000002],[-93.244073999999998,44.968870000000003],[-93.244078999999999,44.969437999999997],[-93.244079999999997,44.969527999999997],[-93.244082000000006,44.969790000000003],[-93.244084000000001,44.969973000000003],[-93.243095999999994,44.969977999999998],[-93.242602000000005,44.969977],[-93.242114999999998,44.969999000000001],[-93.241895999999997,44.970002999999998],[-93.241084000000001,44.970191],[-93.240624999999994,44.970182000000001],[-93.240323000000004,44.970101999999997],[-93.239586000000003,44.969681999999999],[-93.238400999999996,44.969074999999997],[-93.238149000000007,44.969059000000001],[-93.237977000000001,44.969160000000002],[-93.238167000000004,44.969253000000002],[-93.238107999999997,44.969313999999997],[-93.239338000000004,44.969935999999997],[-93.239965999999995,44.970427000000001],[-93.240325999999996,44.970872],[-93.240682000000007,44.971189000000003],[-93.240790000000004,44.971488999999998],[-93.240972999999997,44.971693999999999],[-93.241197999999997,44.972341999999998],[-93.241331000000002,44.973599],[-93.241406999999995,44.974159],[-93.241829999999993,44.974874999999997],[-93.241857999999993,44.975239000000002],[-93.241631999999996,44.975934000000002],[-93.241657000000004,44.97636],[-93.241844999999998,44.976799],[-93.242199999999997,44.977162999999997],[-93.242912000000004,44.977504000000003],[-93.243761000000006,44.977536999999998],[-93.244343000000001,44.977645000000003],[-93.244405,44.977547999999999],[-93.244572000000005,44.977547999999999],[-93.244738999999996,44.97757],[-93.246309999999994,44.977818999999997],[-93.246840000000006,44.977758000000001],[-93.247561000000005,44.977555000000002],[-93.249055999999996,44.977637999999999],[-93.249937000000003,44.977558000000002],[-93.250913999999995,44.977634999999999],[-93.251344000000003,44.977789000000001],[-93.251935000000003,44.97813],[-93.252737999999994,44.978369999999998],[-93.253974999999997,44.978498000000002],[-93.254748000000006,44.978668999999996],[-93.255408000000003,44.978710999999997],[-93.255885000000006,44.978983999999997],[-93.258304999999993,44.980024],[-93.258595,44.980321000000004],[-93.258954000000003,44.980564999999999],[-93.259400999999997,44.980789999999999],[-93.259659999999997,44.981034999999999],[-93.259867,44.981315000000002],[-93.259718000000007,44.981209999999997],[-93.259611000000007,44.981133999999997],[-93.259334999999993,44.981133999999997],[-93.259100000000004,44.980941999999999],[-93.258752999999999,44.980825000000003],[-93.258668,44.980822000000003],[-93.257722999999999,44.980488999999999],[-93.256742000000003,44.980353000000001],[-93.255737999999994,44.980423999999999],[-93.250856999999996,44.981183000000001],[-93.250726999999998,44.981203000000001],[-93.250455000000002,44.981243999999997],[-93.250572000000005,44.981321000000001],[-93.250397000000007,44.981400999999998],[-93.250328999999994,44.981513999999997],[-93.250224000000003,44.981566999999998],[-93.250290000000007,44.981782000000003],[-93.250523999999999,44.981926000000001],[-93.250618000000003,44.982036000000001],[-93.250680000000003,44.982208999999997],[-93.250684000000007,44.982317000000002],[-93.250726999999998,44.982405],[-93.251130000000003,44.982508000000003],[-93.251508999999999,44.982698999999997],[-93.251897,44.982861999999997],[-93.254997000000003,44.984194000000002],[-93.256448000000006,44.984788999999999],[-93.256866000000002,44.984907],[-93.257392999999993,44.985097000000003],[-93.257296999999994,44.985222999999998],[-93.256530999999995,44.984917000000003]]},
{"type":"LineString","coordinates":[[-93.227117000000007,44.972017000000001],[-93.227120999999997,44.972543000000002],[-93.228210000000004,44.972540000000002],[-93.228699000000006,44.972538999999998],[-93.228696999999997,44.973030000000001],[-93.228696999999997,44.973168000000001],[-93.228696999999997,44.973182000000001],[-93.228695999999999,44.973444999999998],[-93.228695999999999,44.973486999999999],[-93.228695000000002,44.973613],[-93.228691999999995,44.973728999999999],[-93.228693000000007,44.973880999999999],[-93.228684999999999,44.974446999999998],[-93.228682000000006,44.974617000000002],[-93.228679999999997,44.974769999999999],[-93.230314000000007,44.974778000000001],[-93.231059999999999,44.974787999999997],[-93.231171000000003,44.974786999999999],[-93.231860999999995,44.974786999999999],[-93.231855999999993,44.974958000000001]]},
{"type":"LineString","coordinates":[[-93.234961999999996,44.977325999999998],[-93.23545,44.977485999999999],[-93.235955000000004,44.977760000000004],[-93.235887000000005,44.977789000000001],[-93.235294999999994,44.978546000000001],[-93.235260999999994,44.978594999999999],[-93.235285000000005,44.978821000000003],[-93.235589000000004,44.978726999999999],[-93.235634000000005,44.978679],[-93.236142999999998,44.978051000000001],[-93.236220000000003,44.977904000000002],[-93.236114000000001,44.977784999999997],[-93.236176,44.97766],[-93.236354000000006,44.977263000000001],[-93.236394000000004,44.977133000000002],[-93.236412999999999,44.977080999999998],[-93.236565999999996,44.976545999999999],[-93.236738000000003,44.976154999999999],[-93.236767999999998,44.976098999999998],[-93.236819999999994,44.976008999999998],[-93.236853999999994,44.975923999999999],[-93.236930000000001,44.975931000000003],[-93.237457000000006,44.975962000000003],[-93.237959000000004,44.975946999999998],[-93.237886000000003,44.975552],[-93.237962999999993,44.974896000000001],[-93.238031000000007,44.972768000000002],[-93.237842999999998,44.97213],[-93.237637000000007,44.971812999999997],[-93.237330999999998,44.971564999999998],[-93.236863999999997,44.971353999999998],[-93.236125999999999,44.971266999999997],[-93.236051000000003,44.971262000000003],[-93.235309000000001,44.971173999999998],[-93.234942000000004,44.971215999999998],[-93.234497000000005,44.971119000000002],[-93.232950000000002,44.970745000000001],[-93.231667999999999,44.970616],[-93.230258000000006,44.970253999999997],[-93.228206999999998,44.969386],[-93.226842000000005,44.968626999999998],[-93.224800000000002,44.967117000000002],[-93.223945999999998,44.966473999999998],[-93.223560000000006,44.966180000000001],[-93.222719999999995,44.965609999999998],[-93.221457999999998,44.965021999999998],[-93.221200999999994,44.964731],[-93.221046000000001,44.964633999999997],[-93.220883999999998,44.964511000000002],[-93.220787999999999,44.964415000000002],[-93.219904999999997,44.963965999999999],[-93.216943999999998,44.961986000000003],[-93.213775999999996,44.959684000000003],[-93.212772000000001,44.958779],[-93.211871000000002,44.957540999999999],[-93.211167000000003,44.956763000000002],[-93.210807000000003,44.956490000000002],[-93.209107000000003,44.955644999999997],[-93.208231999999995,44.955184000000003],[-93.207965999999999,44.954849000000003],[-93.207555999999997,44.954534000000002],[-93.206920999999994,44.954224000000004],[-93.205676999999994,44.953842000000002],[-93.204088999999996,44.953277],[-93.203727999999998,44.953063999999998],[-93.202509000000006,44.952075000000001],[-93.201759999999993,44.951554999999999],[-93.201256999999998,44.951065999999997],[-93.200660999999997,44.950645000000002],[-93.200451000000001,44.950505],[-93.200295999999994,44.950324000000002],[-93.200146000000004,44.949869],[-93.200108999999998,44.949309],[-93.199990999999997,44.949320999999998],[-93.199665999999993,44.948253999999999],[-93.199411999999995,44.946888000000001],[-93.199093000000005,44.946184000000002],[-93.198935000000006,44.946272999999998],[-93.198965000000001,44.946514999999998],[-93.197479999999999,44.946691000000001],[-93.196700000000007,44.946767999999999],[-93.195971,44.946859000000003],[-93.195233999999999,44.946941000000002],[-93.194591000000003,44.947012999999998],[-93.192430999999999,44.947254999999998],[-93.189899999999994,44.947263],[-93.188042999999993,44.947268000000001],[-93.187365999999997,44.947266999999997],[-93.185732000000002,44.947262000000002],[-93.184162999999998,44.947254999999998],[-93.182721000000001,44.947248000000002],[-93.180728999999999,44.947239000000003],[-93.178544000000002,44.947229],[-93.178546999999995,44.947778999999997],[-93.178550999999999,44.948413000000002],[-93.178556999999998,44.948959000000002],[-93.177160000000001,44.94896],[-93.177160999999998,44.948849000000003]]},
{"type":"LineString","coordinates":[[-93.272452999999999,44.986145],[-93.272506000000007,44.986187000000001],[-93.273574999999994,44.986941999999999],[-93.274749999999997,44.986103],[-93.275339000000002,44.985689000000001],[-93.275914,44.985270999999997],[-93.276933,44.984549999999999],[-93.276972000000001,44.984515000000002],[-93.277484000000001,44.984158999999998],[-93.278193999999999,44.983665999999999],[-93.277557000000002,44.983213999999997],[-93.276071000000002,44.982154000000001],[-93.275884000000005,44.982033000000001],[-93.275668999999994,44.981864999999999],[-93.274985999999998,44.981395999999997],[-93.274777999999998,44.981242999999999],[-93.274259000000001,44.981625000000001],[-93.273790000000005,44.981299],[-93.273635999999996,44.981192999999998],[-93.273127000000002,44.980839000000003],[-93.273593000000005,44.980488999999999],[-93.273743999999994,44.980381000000001],[-93.273795000000007,44.980345999999997],[-93.274833000000001,44.979604999999999],[-93.273668999999998,44.978808000000001],[-93.271429999999995,44.977845000000002],[-93.272238999999999,44.976891999999999],[-93.272621999999998,44.976497999999999],[-93.273047000000005,44.975929999999998],[-93.272228999999996,44.975583]]}
          ];
          
          // Start map
          var map = new L.Map('map');
          
        	// Mapbox streets
        	mapboxStreets = new L.TileLayer('http://{s}.tiles.mapbox.com/v3/mapbox.mapbox-streets/{z}/{x}/{y}.png', {
            attribution: 'Map imagery from <a href="http://mapbox.com">Mapbox</a>'
          });
        	map.addLayer(mapboxStreets);
        	
        	// Tilemill testing layer
          var url ='http://localhost:20008/tile/minnpost-nice-ride-testing/{z}/{x}/{y}.png';
          layer = new L.TileLayer(url, { maxZoom: 15, minZoom: 8, scheme: 'xyz' });
          map.addLayer(layer);
          map.setView(new L.LatLng(44.9745, -93.2513), 13);
          
          // Set up animations  (seekFromTo(0.25, 0.75))
          var animations = [];
          for (var i in example_paths) {
            var closureAnimation = (function(path, m, L, mapE, A) {
              return function() {
                var circleOptions = {
                  stroke: false,
                  fillColor: '#168',
                  fillOpacity: 0.9,
                  clickable: false,
                  radius: 10
                };
                var speed = (0.0001056 / 6371); // ?
                var d = mapE.lineDistance(path);
                var time = d / speed;
                var marker = new L.CircleMarker(new L.LatLng(0, 0), circleOptions);
                
                m.addLayer(marker);
                animation = new A({
                  duration: time,
                  interval: 100
                });
                animation.addSubject(animateMarker);
                function animateMarker(interval) {
                  var dist = interval * d;
                  var coord = mapE.coordAtDistance(path, dist);
                  marker.setLatLng(new L.LatLng(coord[1], coord[0]));
                };
                
                return animation;
              }
            })(example_paths[i], map, L, mapExtender, Animator);
            animations[i] = closureAnimation();
          };
          
          // Play animations
          $('body').click(function() {
            for (var a in animations) {
              animations[a].play();
            }
          });
        });
      })(jQuery);
    </script>
  </div>
  <!-- Embed End -->


</body>
</html>